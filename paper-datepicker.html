<link rel="import" href="bower_components/polymer/polymer.html">
<script src="bower_components/moment/min/moment-with-locales.min.js"></script>
<link href="bower_components/paper-dialog/paper-action-dialog.html" rel="import">
<link rel="import" href="bower_components/paper-button/paper-button.html">
<link rel="import" href="bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="bower_components/core-icons/core-icons.html">
<link href="//fonts.googleapis.com/css?family=Roboto:400normal&amp;subset=all" rel="stylesheet" type="text/css">

<polymer-element name="paper-datepicker">
  <template id="paper-datepicker">
    <style notWorking >
      /deep/ #scroller {
        padding: 0; background:#009688;
      }
      /deep/ paper-action-dialog .top {
        color:#fff; text-align:center;
      }
      /deep/ paper-action-dialog.wide .top {
        float: left; min-width: 300px;
      }
      /deep/ paper-action-dialog .top .a {
        background:#00796b; padding: 8px; font-size:14px;
      }
      /deep/ paper-action-dialog .top .b {
        font-size:34px; padding-top:10px; text-transform: uppercase;
      }
      /deep/ paper-action-dialog .top .c {
        font-size:60px;
      }
      /deep/ paper-action-dialog .top .d {
        font-size: 30px; color: #8acfc8; padding: 10px 0 10px;
      }
      /deep/ paper-action-dialog .days {
        background:#fff; text-align:left; padding:0 10px; float: left; width: 300px;
      }
      /deep/ paper-action-dialog .days .a {
        font-size: 15px; text-align:center; font-weight: bold; padding: 17px 0 1px;
      }
      /deep/ paper-action-dialog .days .b { font-size:14px; }
      /deep/ paper-action-dialog .days span.today {
        color:#fff; background:#B0B0B0; border-radius: 20px;
      }
      /deep/ .days.d1 span.d1,
      /deep/ .days.b2 span.b2,
      /deep/ .days.d3 span.d3,
      /deep/ .days.d4 span.d4,
      /deep/ .days.d5 span.d5,
      /deep/ .days.d6 span.d6,
      /deep/ .days.d7 span.d7,
      /deep/ .days.d8 span.d8,
      /deep/ .days.d9 span.d9,
      /deep/ .days.d10 span.d10,
      /deep/ .days.d11 span.d11,
      /deep/ .days.d12 span.d12,
      /deep/ .days.d13 span.d13,
      /deep/ .days.d14 span.d14,
      /deep/ .days.d15 span.d15,
      /deep/ .days.d16 span.d16,
      /deep/ .days.d17 span.d17,
      /deep/ .days.d18 span.d18,
      /deep/ .days.d19 span.d19,
      /deep/ .days.d20 span.d20,
      /deep/ .days.d21 span.d21,
      /deep/ .days.d22 span.d22,
      /deep/ .days.d23 span.d23,
      /deep/ .days.d24 span.d24,
      /deep/ .days.d25 span.d25,
      /deep/ .days.d26 span.d26,
      /deep/ .days.d27 span.d27,
      /deep/ .days.d28 span.d28,
      /deep/ .days.d29 span.d29,
      /deep/ .days.d30 span.d30,
      /deep/ .days.d31 span.d31 {
        color:#fff; background:#009688; border-radius: 20px;,
      }
      /deep/ paper-action-dialog .days span {
        width:39px;display:inline-block;text-align:center;height:39px;line-height:39px;
      }
      /deep/ paper-action-dialog .days .c {
        font-size:14px;margin-top:-21px;
      }
      /deep/ paper-action-dialog paper-button {
        color:#009688;padding:10px;min-width:39px;
      }
      /deep/ paper-action-dialog   {
        font-family: Roboto, "Helvetica Neue", Helvetica, Arial, sans-serif;
      }
      /deep/ #actions { padding: 0; }
    </style>
    <paper-button on-load="{{setup}}" on-tap="{{toggleDialog1}}" raised role="button" tabindex="0">
      {{datePicked|format("l")}}
      <core-icon icon="event" aria-label="event" role="img"></core-icon>
        <paper-action-dialog class="{{orientation}}" backdrop autoCloseDisabled>

            <div class="top">
              <div class="a">{{datePicking|format('dddd')}}</div>
              <div class="b">{{datePicking|format('MMM')}}</div>
              <div class="c">{{datePicking|format('D')}}</div>
              <div class="d">{{datePicking|format('YYYY')}}</div>
            </div>
            <div class="days d{{datePicking|format('D')}}">
              <div class="a" >
                <core-icon on-click="{{backMonth}}" style="color:#aaa;float:left" icon="arrow-back" role="img"></core-icon>
                {{datePicking|format('MMMM YYYY')}}
                <core-icon on-click="{{forwardMonth}}" style="color:#aaa;float:right" icon="arrow-forward" role="img"></core-icon>
              </div>
              <div class="b">
                <template repeat="{{ day_of_the_week in days_of_the_week }}">
                  <span>{{day_of_the_week | firstLetter}}</span>
                </template>
              </div>
              <div class="c">
                <template repeat="{{ day in notDays }}">
                  <span></span>
                </template>
                <template repeat="{{ day in days }}">
                  <span class="{{day | today}} d{{day}}" on-click="{{ dateClicked }}" role="button" >{{day}}</span>
                </template>
              </div>
            </div>
            <paper-button affirmative>CANCEL</paper-button>
            <paper-button affirmative autofocus on-click="{{set_datePicked}}">OK</paper-button>
          </paper-action-dialog>
      </paper-button>
  </template>

  <script>
    moment.locale('en-gb');
var scope;
    Polymer("paper-datepicker", {
      publish: {
        datePicked:{},
        days:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],
        notDays: [],
        locale: 'en-gb',
      // Defines the date-picker layout mode ('vertical' OR 'horizontal')
        orientation: 'vertical',
      //locales:

      // af = Afrikaans,sq = Albanian,ar = Arabic,ar-ma = Arabic (Morocco),ar-sa = Arabic (Saudi Arabia),hy-am = Armenian,az = Azerbaijani,id = Bahasa Indonesia,ms-my = Bahasa Malayu,eu = Basque,be = Belarusian,bn = Bengali,bs = Bosnian,br = Breton,bg = Bulgarian,my = Burmese,ca = Catalan,zh-cn = Chinese,zh-tw = Chinese (Traditional),cv = Chuvash,hr = Croatian,cs = Czech,da = Danish,nl = Dutch,en = English,en-au = English (Australia),en-ca = English (Canada),en-gb = English (England),eo = Esperanto,et = Estonian,fo = Farose,fi = Finnish,fr = French,fr-ca = French (Canada),gl = Galician,ka = Georgian,de = German,de-at = German (Austria),el = Greek,he = Hebrew,hi = Hindi,hu = Hungarian,is = Icelandic,it = Italian,ja = Japanese,km = Khmer (Cambodia),ko = Korean,lv = Latvian,lt = Lithuanian,lb = Luxembourgish,mk = Macedonian,ml = Malayalam,mr = Marathi,ne = Nepalese,nb = Norwegian,nn = Norwegian Nynorsk,fa = Persian,pl = Polish,pt = Portuguese,pt-br = Portuguese (Brazil),ro = Romanian,ru = Russian,sr = Serbian,sr-cyrl = Serbian Cyrillic,sk = Slovak,sl = Slovenian,es = Spanish,sv = Swedish,tl-ph = Tagalog (Filipino),tzm = Tamaziɣt,tzm-latn = Tamaziɣt Latin,ta = Tamil,th = Thai,bo = Tibetan,tr = Turkish,uk = Ukrainia,uz = Uzbe,vi = Vietnamese,cy = Welsh

      },
      dateClicked: function(e) {
        var element = e.originalTarget ? e.originalTarget : e.toElement;
        scope.datePicking = moment(element.textContent, 'D')
      },
      datePicking: moment(),
      days_of_the_week: moment.weekdaysMin(),
      backMonth: function() {
        this.datePicking = moment(this.datePicking).subtract(1, 'months');
      },
      forwardMonth: function() {
        this.datePicking = moment(this.datePicking).add(1, 'months');
      },
      set_datePicked: function() { 
        this.datePicked = this.datePicking;
      },
      toggleDialog1: function(e) {
        var d = e.target.querySelector('paper-action-dialog');
        if (!d) {
          return;
        }
        d.toggle();
      },
      ready: function() {
        var notdays = +moment(1,"D").format("d")-1;
        if (notdays >= 0) {
          this.notDays[ notdays ] = "";
        }
        for(i=1;i<=moment(this.datePicking).daysInMonth();i++){
          this.days[i-1] = i;
        }
        this.datePicking = moment();
        this.datePicked = moment();
        scope = this;
      }
    });
    PolymerExpressions.prototype.firstLetter = function(input) {
      return input[0];
    };
    PolymerExpressions.prototype.today = function(input) {
      if ( moment(input ,"D").isSame(moment(), "day" )) {
        return "today";
      }
    };
    PolymerExpressions.prototype.format = function(input, letter) {
        return moment(input).format(letter);
    };
  </script>
</polymer-element>
